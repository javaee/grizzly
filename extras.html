
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2017-05-03
 Rendered using Maven Reflow Skin 1.0.0 (http://andriusvelykis.github.com/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Project Grizzly - Core Framework Extras</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />
 
		<link href="//netdna.bootstrapcdn.com/bootswatch/2.2.2/cosmo/bootstrap.min.css" rel="stylesheet" />
		<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="https://grizzly.java.net/css/bootswatch.css" rel="stylesheet" />
		<link href="https://grizzly.java.net/css/reflow-skin.css" rel="stylesheet" />
		
		<link href="//yandex.st/highlightjs/7.3/styles/solarized_dark.min.css" rel="stylesheet" />
		
		<link href="https://grizzly.java.net/css/lightbox.css" rel="stylesheet" />
		
		<link href="https://grizzly.java.net/css/site.css" rel="stylesheet" />
		<link href="https://grizzly.java.net/css/print.css" rel="stylesheet" media="print" />
		
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->

	</head>

	<body class="page-extras project-site" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="index.html">Project <span class="color-brown">Grizzly</span></a>
					<div class="nav-collapse">
						<ul class="nav pull-right">
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Download <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="dependencies.html" title="Download">Download </a></li>
								</ul>
							</li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="overview.html" title="Overview">Overview </a></li>
									<li><a href="dependencies.html" title="Dependencies">Dependencies </a></li>
									<li class="dropdown-submenu">
										<a href="hack" title="Core Framework">Core Framework </a>
										<ul class="dropdown-menu">
											<li><a href="memory.html" title="Memory Management">Memory Management </a></li>
											<li><a href="iostrategies.html" title="I/O Strategies">I/O Strategies </a></li>
											<li><a href="transportsconnections.html" title="Transports and Connections">Transports and Connections </a></li>
											<li><a href="filterchainfilters.html" title="FilterChain and Filters">FilterChain and Filters </a></li>
											<li><a href="coreconfig.html" title="Core configuration">Core configuration </a></li>
											<li><a href="portunification.html" title="Port Unification">Port Unification </a></li>
											<li><a href="monitoring.html" title="Monitoring">Monitoring </a></li>
											<li class="active"><a href="" title="Extras">Extras </a></li>
											<li><a href="bestpractices.html" title="Best Practices">Best Practices </a></li>
											<li><a href="quickstart.html" title="Quick Start">Quick Start </a></li>
											<li><a href="samples.html" title="Samples">Samples </a></li>
										</ul>
									</li>
									<li class="dropdown-submenu">
										<a href="hack" title="HTTP">HTTP </a>
										<ul class="dropdown-menu">
											<li><a href="httpframework.html" title="Core HTTP Framework">Core HTTP Framework </a></li>
											<li><a href="httpserverframework.html" title="HTTP Server Framework">HTTP Server Framework </a></li>
											<li><a href="http2.html" title="HTTP/2">HTTP/2 </a></li>
											<li><a href="httpserverframeworkextras.html" title="HTTP Server Framework Extras">HTTP Server Framework Extras </a></li>
											<li><a href="comet.html" title="Comet">Comet </a></li>
											<li><a href="jaxws.html" title="JAXWS">JAXWS </a></li>
											<li><a href="websockets.html" title="WebSockets">WebSockets </a></li>
											<li><a href="ajp.html" title="AJP">AJP </a></li>
											<li><a href="spdy.html" title="SPDY">SPDY </a></li>
										</ul>
									</li>
									<li class="dropdown-submenu">
										<a href="hack" title="Javadocs/XREF">Javadocs/XREF </a>
										<ul class="dropdown-menu">
											<li><a href="https://grizzly.java.net/docs/2.3/apidocs" title="Grizzly 2.3 Javadoc" class="externalLink">Grizzly 2.3 Javadoc </a></li>
											<li><a href="https://grizzly.java.net/docs/2.3/xref" title="Grizzly 2.3 XRef" class="externalLink">Grizzly 2.3 XRef </a></li>
											<li><a href="https://grizzly.java.net/docs/2.2/apidocs" title="Grizzly 2.2 Javadoc" class="externalLink">Grizzly 2.2 Javadoc </a></li>
											<li><a href="https://grizzly.java.net/docs/2.2/xref" title="Grizzly 2.2 XRef" class="externalLink">Grizzly 2.2 XRef </a></li>
											<li><a href="https://grizzly.java.net/docs/1.9/apidocs" title="Grizzly 1.9 Javadoc" class="externalLink">Grizzly 1.9 Javadoc </a></li>
											<li><a href="https://grizzly.java.net/docs/1.9/xref" title="Grizzly 1.9 XRef" class="externalLink">Grizzly 1.9 XRef </a></li>
										</ul>
									</li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
		
	<div class="container">
	
	<!-- Masthead
	================================================== -->
	<header class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<a href="index.html" id="bannerLeft"><h1><img src="images/grizzlyHead.png"/>&nbsp;<span class="color-black">Project</span> Grizzly</h1></a>
					<p class="lead">NIO Event Development Simplified</p>
				</div>
				<div class="pull-right">
				</div>
			</div>
		</div>
		<div>
			<ul class="breadcrumb">
				<li class="publishDate version-date">Last Published: 2017-05-03</li>
			</ul>
		</div>
		<hr class="toc-separator" />
		<div id="toc-bar" class="navbar">
			<div class="navbar-inner">
				<div id="toc-scroll-target" class="container">
					<ul id="toc" class="nav">
						<li class="dropdown">
							<a href="#Core_Framework_Extras" title="Core Framework Extras" class="dropdown-toggle" role="button" data-toggle="dropdown" data-target="#">Core Framework Extras <b class="caret"></b></a>
							<ul class="dropdown-menu" role="menu">
								<!-- Repeat the item, otherwise it is not clickable as the dropdown root -->
								<li><a href="#Core_Framework_Extras" title="Core Framework Extras">Core Framework Extras</a></li>
								<li class="divider"></li>
								<li><a href="#Client-Side_Connection_Pool" title="Client-Side Connection Pool">Client-Side Connection Pool</a></li>

							</ul>
						</li>
						<li class="divider-vertical"></li>
						<li class="toplevel"><a href="#SingleEndpointPool" title="SingleEndpointPool">SingleEndpointPool</a></li>
						<li class="divider-vertical"></li>
						<li class="toplevel"><a href="#SingleEndpointPool_Configuration" title="SingleEndpointPool Configuration">SingleEndpointPool Configuration</a></li>
						<li class="divider-vertical"></li>
						<li class="toplevel"><a href="#MultiEndpointPool" title="MultiEndpointPool">MultiEndpointPool</a></li>
		<li class="divider-vertical"></li>
		<li class="dropdown">
			<a href="#" title="More&hellip;" class="dropdown-toggle" role="button" data-toggle="dropdown" data-target="#">&hellip; <b class="caret"></b></a>
			<ul class="dropdown-menu" role="menu">
								<li><a href="#MultiEndpointPool_Configuration" title="MultiEndpointPool Configuration">MultiEndpointPool Configuration</a></li>
								<li class="dropdown-submenu">
									<a href="#Samples" title="Samples">Samples</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#Server_Name_Indication_SNI_TLS_extension_support" title="Server Name Indication (SNI) TLS extension support">Server Name Indication (SNI) TLS extension support</a></li>

									</ul>
								</li>
								<li><a href="#SNI_server-side_support" title="SNI server-side support">SNI server-side support</a></li>
								<li><a href="#SNI_client-side_support" title="SNI client-side support">SNI client-side support</a></li>

			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span12">
			<div class="body-content">
<div class="section"> 
 <div class="page-header">
  <h2 id="Core_Framework_Extras">Core Framework Extras</h2>
 </div> 
 <p>These following are extras built off the core Grizzly framework.</p> 
 <div class="section"> 
  <h3 id="Client-Side_Connection_Pool">Client-Side Connection Pool</h3> 
  <p>As of Grizzly 2.3.4, a new client-side connection pool API has been introduced. This API is completely different from one provided by Grizzly 1.9.x, it has more features and hopefully is nicer and easier to use. There are 2 main abstractions: SingleEndpointPool and MultiEndpointPool, which represent a connection pool to a single and multiple endpoints respectively. Each connection pool abstraction has a builder, which helps to construct and initialize a connection pool of a specific configuration.</p> 
  <p>The javadocs for the full connection pool package may be found <a class="externalLink" href="https://grizzly.java.net/docs/2.3/apidocs/org/glassfish/grizzly/connectionpool/package-summary.html">here</a>.</p> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="SingleEndpointPool">SingleEndpointPool</h2> 
 <p>The <a class="externalLink" href="https://grizzly.java.net/docs/2.3/apidocs/org/glassfish/grizzly/connectionpool/SingleEndpointPool.html">SingleEndpointPool</a> represents a connection pool to a single endpoint. For example if we want to create a connection pool to “grizzly.java.net:443″ and set the maximum number of connections in pool equal to eight – the code will look like:</p> 
 <div class="source"> 
  <pre>TCPNIOTransport transport = TCPNIOTransportBuilder.newInstance()
                .processor(myFilterChain)
                .build();
transport.start();

SingleEndpointPool pool = SingleEndpointPool
                .builder(SocketAddress.class)
                .connectorHandler(transport)
                .endpointAddress(new InetSocketAddress(&quot;grizzly.java.net&quot;, 443))
                .maxPoolSize(8)
                .build();

try {
    // use the connection pool
    ............
} finally {
    pool.close();
    transport.shutdownNow();
}
</pre> 
 </div> 
 <p>A Connection could be asynchronously obtained from the pool using either Future or CompletionHandler:</p> 
 <div class="source"> 
  <pre>Future&lt;Connection&gt; connectionFuture = pool.take();
</pre> 
 </div> 
 <p>or</p> 
 <div class="source"> 
  <pre>CompletionHandler&lt;Connection&gt; myCompletionHandler = createMyCompletionHandler();
pool.take(myCompletionHandler);
</pre> 
 </div> 
 <p>Please note, if you try to retrieve a Connection using Future, but suddenly changed your mind and don’t want to wait for a Connection, you have to use the code like:</p> 
 <div class="source"> 
  <pre>if (!connectionFuture.cancel(false)) {
    // means Connection is ready
    pool.release(connectionFuture.get());
}
</pre> 
 </div> 
 <p>to properly cancel the asynchronous operation and return a Connection (if there is any) back to the pool. In general it is highly important to return a Connection back to a pool once you don’t need it to avoid connection pool starvation, which will make connection pool useless.</p> 
 <div class="source"> 
  <pre>pool.release(connection);
</pre> 
 </div> 
 <p>Another interesting feature of Grizzly connection pool, is the ability to attach/detach connections to/from a pool. For example if you retrieved a connection, but don’t plan to use it as part of the pool or don’t plan to return it back to the pool, you can detach this connection:</p> 
 <div class="source"> 
  <pre>Connection connection = pool.take().get(10, TimeUnit.SECONDS);
pool.detach(connection);
</pre> 
 </div> 
 <p>and the pool will be able to establish a new connection (lazily, if needed) to reimburse it. On other hand if you have a connection, created outside the pool (or detached from the pool) and you want to attach this connection to the pool – you can call:</p> 
 <div class="source"> 
  <pre>pool.attach(foreignConnection);
</pre> 
 </div> 
 <p>When the pool is not needed anymore (usually when you exit application), it is recommended to close it:</p> 
 <div class="source"> 
  <pre>pool.close();
</pre> 
 </div> 
 <p>During the close() operation execution all the idle connections will be closed. The busy connections, which were not returned back to the pool yet, will be kept open and will be closed once you will try to return them back to the pool.</p> 
</div> 
<div class="section"> 
 <h2 id="SingleEndpointPool_Configuration">SingleEndpointPool Configuration</h2> 
 <table border="0" class="bodyTable table table-striped table-hover" style="font-size:75%;"> 
  <thead> 
   <tr class="a"> 
    <th style="width:10%;padding:4px;" align="center">Property</th> 
    <th style="width:60%;padding:4px;" align="center">Description</th> 
    <th style="width:30%;padding:4px;" align="center">Notes</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr class="b"> 
    <td style="padding:10px;">connectorHandler</td> 
    <td style="padding:10px;">The ConnectorHandler to be used to establish Connections to the endpoint</td> 
    <td style="padding:10px;" align="center">mandatory</td> 
   </tr> 
   <tr class="a"> 
    <td style="padding:10px;">endpointAddress</td> 
    <td style="padding:10px;">The remote endpoint address to open Connection to</td> 
    <td style="padding:10px;" align="center">mandatory</td> 
   </tr> 
   <tr class="b"> 
    <td style="padding:10px;">localEndpointAddress</td> 
    <td style="padding:10px;">The local endpoint address to bind Connection to</td> 
    <td style="padding:10px;" align="center">optional</td> 
   </tr> 
   <tr class="a" id="corepoolsize"> 
    <td style="padding:10px;">corePoolSize</td> 
    <td style="padding:10px;">The number of Connections, kept in the pool, that are immune to keep-alive mechanism</td> 
    <td style="padding:10px;" align="center">Default value: 0</td> 
   </tr> 
   <tr class="b"> 
    <td style="padding:10px;">maxPoolSize</td> 
    <td style="padding:10px;">The max number of Connections kept by this pool</td> 
    <td style="padding:10px;" align="center">Default value: 4</td> 
   </tr> 
   <tr class="a"> 
    <td style="padding:10px;">connectTimeout</td> 
    <td style="padding:10px;">The connect timeout, after which, if a connection is not established, it is considered failed</td> 
    <td style="padding:10px;" align="center">value &lt; 0 disables the timeout. By default disabled</td> 
   </tr> 
   <tr class="b"> 
    <td style="padding:10px;">reconnectDelay</td> 
    <td style="padding:10px;">The delay to be used before the pool will repeat the attempt to connect to the endpoint after previous connect had failed</td> 
    <td style="padding:10px;" align="center">value &lt; 0 disables reconnect. By default disabled</td> 
   </tr> 
   <tr class="a"> 
    <td style="padding:10px;">maxReconnectAttempts</td> 
    <td style="padding:10px;">The maximum number of attempts to reconnect that will be made before notification of failure occurs</td> 
    <td style="padding:10px;" align="center">Default value: 5</td> 
   </tr> 
   <tr class="b"> 
    <td style="padding:10px;">keepAliveTimeout</td> 
    <td style="padding:10px;">The maximum amount of time an idle Connection will be kept in the pool. The idle Connections will be closed till the pool size is greater than <a href="#corepoolsize">corePoolSize</a></td> 
    <td style="padding:10px;" align="center">value &lt; 0 disables keep-alive mechanism. Default value: 30 seconds</td> 
   </tr> 
   <tr class="a"> 
    <td style="padding:10px;">keepAliveCheckInterval</td> 
    <td style="padding:10px;">The interval, which specifies how often the pool will perform idle Connections check</td> 
    <td style="padding:10px;" align="center">Default value: 5 seconds</td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<div class="section"> 
 <h2 id="MultiEndpointPool">MultiEndpointPool</h2> 
 <p>The <a class="externalLink" href="https://grizzly.java.net/docs/2.3/apidocs/org/glassfish/grizzly/connectionpool/MultiEndpointPool.html">MultiEndpointPool</a> represents a connection pool to multiple endpoints. We can think of MultiEndpointPool as an Endpoint-to-SingleEndpointPool map, where each endpoint is represented by an EndpointKey. The MultiEndpointPool supports pretty much the same set of operations as SingleEndpointPool, but some of these operations (especially related to the Connection allocation) require EndpointKey parameter. Here is an example of MultiEndpointPool, which is used to allocate connections to 2 different servers:</p> 
 <div class="source"> 
  <pre>// Build a connection pool
MultiEndpointPool pool = MultiEndpointPool
          .builder(SocketAddress.class)
          .connectorHandler(transport)
          .maxConnectionsPerEndpoint(4)
          .maxConnectionsTotal(16)
          .build();

// define endpoints
EndpointKey endpointKey1 =
           new EndpointKey(&quot;endpoint1&quot;,
                           new InetSocketAddress(&quot;grizzly.java.net&quot;, 80));
EndpointKey endpointKey2 =
           new EndpointKey(&quot;endpoint2&quot;,
                           new InetSocketAddress(&quot;mytecc.wordpress.com&quot;, 80));
Connection c1 = null;
Connection c2 = null;
try {
    c1 = pool.take(endpointKey1).get();
    c2 = pool.take(endpointKey2).get();
..........................
} finally {
    if (c1 != null) {
        pool.release(c1);
    }
    if (c2 != null) {
        pool.release(c2);
    }
}
</pre> 
 </div> 
 <p>The SingleEndpointPool and the MultiEndpointPool have similar configuration properties, which could be tuned: max pool size, connect timeout, keep-alive timeout, reconnect delay etc. Additionally for MultiEndpointPool it is possible to tune max connections per endpoint property, which lets us limit the maximum number of connections to a single endpoint.</p> 
</div> 
<div class="section"> 
 <h2 id="MultiEndpointPool_Configuration">MultiEndpointPool Configuration</h2> 
 <table border="0" class="bodyTable table table-striped table-hover" style="font-size:75%;"> 
  <thead> 
   <tr class="a"> 
    <th style="width:10%;padding:4px;" align="center">Property</th> 
    <th style="width:60%;padding:4px;" align="center">Description</th> 
    <th style="width:30%;padding:4px;" align="center">Notes</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr class="b"> 
    <td style="padding:10px;">defaultConnectorHandler</td> 
    <td style="padding:10px;">The default ConnectorHandler to be used to establish Connections to an endpoint</td> 
    <td style="padding:10px;" align="center">mandatory. It is still possible to set a ConnectorHandler per each endpoint separately</td> 
   </tr> 
   <tr class="a"> 
    <td style="padding:10px;">maxConnectionsPerEndpoint</td> 
    <td style="padding:10px;">The maximum number of Connections each SingleEndpointPool sub-pool is allowed to have</td> 
    <td style="padding:10px;" align="center">Default value: 2</td> 
   </tr> 
   <tr class="b"> 
    <td style="padding:10px;">maxConnectionsTotal</td> 
    <td style="padding:10px;">The total maximum number of Connections to be kept by the pool</td> 
    <td style="padding:10px;" align="center">Default value: 16</td> 
   </tr> 
   <tr class="a"> 
    <td style="padding:10px;">connectTimeout</td> 
    <td style="padding:10px;">The connect timeout, after which, if a connection is not established, it is considered failed</td> 
    <td style="padding:10px;" align="center">value &lt; 0 disables the timeout. By default disabled</td> 
   </tr> 
   <tr class="b"> 
    <td style="padding:10px;">reconnectDelay</td> 
    <td style="padding:10px;">The delay to be used before the pool will repeat the attempt to connect to the endpoint after previous connect had failed</td> 
    <td style="padding:10px;" align="center">value &lt; 0 disables reconnect. By default disabled</td> 
   </tr> 
   <tr class="a"> 
    <td style="padding:10px;">maxReconnectAttempts</td> 
    <td style="padding:10px;">The maximum number of attempts to reconnect that will be made before notification of failure occurs</td> 
    <td style="padding:10px;" align="center">Default value: 5</td> 
   </tr> 
   <tr class="b"> 
    <td style="padding:10px;">keepAliveTimeout</td> 
    <td style="padding:10px;">The maximum amount of time an idle Connection will be kept in the pool</td> 
    <td style="padding:10px;" align="center">value &lt; 0 disables keep-alive mechanism. Default value: 30 seconds</td> 
   </tr> 
   <tr class="a"> 
    <td style="padding:10px;">keepAliveCheckInterval</td> 
    <td style="padding:10px;">The interval, which specifies how often the pool will perform idle Connections check</td> 
    <td style="padding:10px;" align="center">Default value: 5 seconds</td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<div class="section"> 
 <h2 id="Samples">Samples</h2> 
 <p>A complete example using the MultiEndpointPool may be found <a class="externalLink" href="https://github.com/GrizzlyNIO/grizzly-mirror/tree/2.3.x/samples/connection-pool-samples/src/main/java/org/glassfish/grizzly/samples/connectionpool">here</a>.</p> 
 <div class="section"> 
  <h3 id="Server_Name_Indication_SNI_TLS_extension_support">Server Name Indication (SNI) TLS extension support</h3> 
  <p>Grizzly 2.3.12 and later includes SNI TLS extension support for both server and client side. The client implementation is based on JDK 7 client-side SNI support, so it will work on JDK 7+ only, the server implementation doesn’t rely on JDK SNI support and could be used on any JDK supported by the core Grizzly framework. The core SNI functionality is implemented as part of <tt>SNIFilter</tt>, which is an extension of <tt>SSLFilter</tt>. The first step to start using the SNI extension is to insert the <tt>SNIFilter</tt> into the FilterChain (replacing the <tt>SSLFilter</tt>, if the one is used) and pass default <tt>SSLEngineConfigurator</tt> settings, which will be used for non SNI-aware Connections.</p> 
  <div class="source"> 
   <pre>SSLEngineConfigurator serverEngineConfig = createDefaultServerSideConfig();
SSLEngineConfigurator clientEngineConfig = createDefaultClientSideConfig();

SNIFilter sniFilter = new SNIFilter(serverEngineConfig, clientEngineConfig);
</pre> 
  </div> 
  <p>The instructions for the server and the client side support for the SNI extension are different, so they will be covered separately.</p> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="SNI_server-side_support">SNI server-side support</h2> 
 <p>The Grizzly server-side SNI implementation allows users to chose an SSL configuration, represented by SSLEngineConfigurator, for each accepted connection, based on a SNI host name information passed by a client. In order to achieve this, the user has to create and register an <tt>SNIServerConfigResolver</tt>:</p> 
 <div class="source"> 
  <pre>// Register SNIServerConfigResolver to handle new SNI-aware Connections
// and chose proper SSL configuration based on the SNI host passed by
// clients
sniFilter.setServerSSLConfigResolver(new SNIServerConfigResolver() {

    @Override
    public SNIConfig resolve(Connection connection, String hostname) {
        SSLEngineConfigurator sslEngineConfig = host2SSLConfigMap.get(hostname);

        // if sslEngineConfig is null - default server-side configuration,
        // which was passed in the SNIFilter constructor, will be used.

        return SNIConfig.newServerConfig(sslEngineConfig);
    }
});
</pre> 
 </div> 
 <p>the main responsibility of <tt>SNIServerConfigResolver</tt> is to provide custom SSL configuration for an accepted connection based on the SNI host name provided by a client.</p> 
</div> 
<div class="section"> 
 <h2 id="SNI_client-side_support">SNI client-side support</h2> 
 <p>By default, there’s no additional configuration to SNI-enable the client outside of adding the <tt>SNIFilter</tt> to a FilterChain. Every time a client-side connection is established, Grizzly will pick up the remote host address specified by a user and send it to the server as SNI host. Please note that according to the SNI specification, IP addresses are not considered a valid SNI host. If an IP address is used to establish a client-side connection, no SNI host information will be sent to a server. See the following example:</p> 
 <div class="source"> 
  <pre>SSLEngineConfigurator serverEngineConfig = createDefaultServerSideConfig();
SSLEngineConfigurator clientEngineConfig = createDefaultClientSideConfig();

SNIFilter sniFilter = new SNIFilter(serverEngineConfig, clientEngineConfig);

FilterChain chain = FilterChainBuilder.stateless()
        .add(new TransportFilter())
        .add(sniFilter)
        ......
        .build();

TCPNIOTransport transport = TCPNIOTransportBuilder.newInstance()
        .setProcessor(chain)
        .build();

transport.start();

Connection c1 = transport.connect(&quot;grizzly.java.net&quot;, 443).get();
Connection c2 = transport.connect(&quot;10.20.30.40&quot;, 443).get();
</pre> 
 </div> 
 <p>Connection c1 will be established and “grizzly.java.net” will be sent to a server as SNI host information, however connection C2 will not pass any SNI host information to the server, because an IP address was used.</p> 
 <p>If SNI host customization is required on the client, the user may register an <tt>SNIClientConfigResolver</tt>:</p> 
 <div class="source"> 
  <pre>// Register SNIClientConfigResolver to handle new SNI-aware Connections
// and chose proper host name and SSL configuration to be used for
// a client-side Connection
sniFilter.setClientSSLConfigResolver(new SNIClientConfigResolver() {

    @Override
    public SNIConfig resolve(Connection connection) {
        return SNIConfig.newClientConfig(&quot;my.hostname&quot;);
    }
});
</pre> 
 </div> 
 <p>So if we use <tt>SNIClientConfigResolver</tt> with our first example:</p> 
 <div class="source"> 
  <pre>SSLEngineConfigurator serverEngineConfig = createDefaultServerSideConfig();
SSLEngineConfigurator clientEngineConfig = createDefaultClientSideConfig();

SNIFilter sniFilter = new SNIFilter(serverEngineConfig, clientEngineConfig);

// Register SNIClientConfigResolver to handle new SNI-aware Connections
// and chose proper host name and SSL configuration to be used for
// a client-side Connection
sniFilter.setClientSSLConfigResolver(new SNIClientConfigResolver() {

    @Override
    public SNIConfig resolve(Connection connection) {
        return SNIConfig.newClientConfig(&quot;my.hostname&quot;);
    }
});

FilterChain chain = FilterChainBuilder.stateless()
        .add(new TransportFilter())
        .add(sniFilter)
        ......
        .build();

TCPNIOTransport transport = TCPNIOTransportBuilder.newInstance()
        .setProcessor(chain)
        .build();

transport.start();

Connection c2 = transport.connect(&quot;10.20.30.40&quot;, 443).get();
</pre> 
 </div> 
 <p>Connection c1 will be established and “my.hostname” will be sent to a server as SNI host information.</p> 
</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->
	
	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li>
							<a href="index.html" title="Home">Home </a>
						</li>
						<li>
							<a href="license.html" title="License">License </a>
						</li>
						<li>
							<a href="using.html" title="Who's Using Grizzly">Who's Using Grizzly </a>
						</li>
						<li class="nav-header">Download</li>
						<li>
							<a href="dependencies.html" title="Download">Download </a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Contribute</li>
						<li>
							<a href="contribute.html" title="Contribute">Contribute </a>
						</li>
						<li>
							<a href="http://stackoverflow.com/questions/tagged/grizzly" title="StackOverflow" class="externalLink">StackOverflow </a>
						</li>
						<li>
							<a href="https://twitter.com/project_grizzly" title="Twitter" class="externalLink">Twitter </a>
						</li>
						<li>
							<a href="mailing.html" title="Mailing Lists">Mailing Lists </a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Project Info</li>
						<li>
							<a href="scm.html" title="Source Control">Source Control </a>
						</li>
						<li>
							<a href="https://java.net/jira/browse/GRIZZLY/" title="Issue Tracking" class="externalLink">Issue Tracking </a>
						</li>
						<li>
							<a href="mailing.html" title="Mailing Lists">Mailing Lists </a>
						</li>
						<li>
							<a href="team-list.html" title="Project Team">Project Team </a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</footer>
		
	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2017. All Rights Reserved.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->

	<!-- Fallback jQuery loading from Google CDN:
	     http://stackoverflow.com/questions/1014203/best-way-to-use-googles-hosted-jquery-but-fall-back-to-my-hosted-library-on-go -->
	<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script type="text/javascript">
		if (typeof jQuery == 'undefined')
		{
			document.write(unescape("%3Cscript src='https://grizzly.java.net/js/jquery-1.8.3.min.js' type='text/javascript'%3E%3C/script%3E"));
		}
	</script>
	
	<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>
	<script src="https://grizzly.java.net/js/lightbox.js"></script>
	<script src="https://grizzly.java.net/js/jquery.smooth-scroll.min.js"></script>
	<!-- back button support for smooth scroll -->
	<script src="https://grizzly.java.net/js/jquery.ba-bbq.min.js"></script>
	<script src="//yandex.st/highlightjs/7.3/highlight.min.js"></script>

	<script src="https://grizzly.java.net/js/reflow-skin.js"></script>
	
	</body>
</html>
